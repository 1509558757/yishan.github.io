---
title: 设计模式之命令模式
date: 2020-10-27 18:41:55
tags: [java基础,设计模式]
---
### 命令模式command
<!-- more -->
- 介绍
    - 命令模式：将一个请求封装为一个对象，从而使我们可用不同的请求对客户进行参数化；对请求排队或者记录请求日志，以及支持可撤销的操作。也称之为：动作Action模式、事务transaction模式
- 结构
    - Command抽象命令类
    - ConcreteCommand具体命令类
    - Invoken调用者/请求者
        - 请求的发送者，它通过命令对象来执行请求。一个调用者并不需要在设计时确定其接受者，因此它只与抽象命令类之间存在关联。在程序运行时，将调用命令对象的execute()，间接调用接受者的相关操作。
    - Receiver接收者
        - 接收者执行与请求相关的操作，具体实现对请求的业务处理。
        - 未抽象前，实际执行操作内容的对象。
    - Client客户类
        - 在客户类中需要创建调用者对象、具体命令类对象，在创建具体命令对象时指定对应的接收者。发送者和接收者之间没有直接关系，都通过命令对象间接调用。

### 示例代码

        package com.yishan.command;

        /**
        * 策略模式
        * 真正的命令的执行者
        * @author : yishan
        * @date : 2020-10-27 20:09
        */
        public class Receiver {
            public void action(){
                System.out.println("Receiver.action()");
            }
        }



        package com.yishan.command;

        /**
        * @author : yishan
        * @date : 2020-10-27 20:11
        */
        public interface Command {
            /**
            * 这个方法是一个返回结果为空的方法
            * 实际项目中，可以根据需求设计多个不同的方法
            */
            void execute();
        }

        class ConcreteCommand implements Command{

            private Receiver receiver; //命令的真正的执行者

            public ConcreteCommand(Receiver receiver) {
                this.receiver = receiver;
            }

            @Override
            public void execute() {
                //命令真正执行前或后，执行相关的处理！
                receiver.action();

            }
        }



        package com.yishan.command;

        /**
        * 调用者、发起者
        * @author : yishan
        * @date : 2020-10-27 20:15
        */
        public class Invoke {
            private Command command;//也可以通过容器List<Command>容纳很多命令对象，进行批处理。数据可底层的事务管理就是类似的结构

            public Invoke(Command command) {
                this.command = command;
            }

            //业务方法，用于调用命令类的方法
            public void call(){
                command.execute();
            }
        }


        package com.yishan.command;

        /**
        * 测试
        * @author : yishan
        * @date : 2020-10-27 20:18
        */
        public class Client {
            public static void main(String[] args) {
                Command c = new ConcreteCommand(new Receiver());

                Invoke i = new Invoke(c);

                i.call();

                new Receiver().action();
            }
        }

### 开发中常见的场景
- Struts2中，action的整个调用过程中就有命令模式。
- 数据库事务机制的底层实现
- 命令的撤销和恢复